<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Food Left Counter</title>
  <style>
    @font-face {
      font-family: 'DIN Condensed';
      src: url('din-condensed-bold.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
    }

    :root{
      --bg: #001f3f;
      --lion: #F4C430;
    }
    html,body{
      height:100%;
      margin:0;
      overflow:hidden;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;
    }
    body{
      background:var(--bg);
      color:var(--lion);
      display:flex;
      flex-direction:column;
      font-family: 'DIN Condensed';
    }

    .stage{
      flex:1;
      display:flex;
      flex-direction:row;
      justify-content:space-between;
      align-items:flex-start;
      padding:4vmin 6vmin;
      box-sizing:border-box;
      height:100%;
    }

    .left{
      display:flex;
      flex-direction:column;
      justify-content:center;
      flex:1 1 85%; /* fixed proportion */
      min-width:0;
    }

    .count{
      font-weight:900;
      font-size:90vmin;
      line-height:0.75;
      margin:0;
      transform-origin:left center;
      transition:transform 120ms ease, opacity 120ms ease;
      will-change:transform, opacity;
      max-width:100%;
      overflow-wrap:break-word;
      word-break:break-word;
    }

    .label{
      font-size:15vmin;
      font-weight:700;
      margin:2vmin 0 0 4vmin;
    }

    .right{
      display:flex;
      flex-direction:column;
      justify-content:flex-end;
      gap:6px;
      flex:0 0 15%; /* fixed width */
      height:100%;
    }

    .right-inner {
      display:flex;
      flex-direction:column;
      margin-top:auto;
      gap:6px;
    }

    input[type=number]{
      font-size:20px;
      padding:10px 12px;
      border-radius:8px;
      border:2px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.03);
      color:var(--lion);
      width:100%;
      outline:none;
      box-sizing:border-box;
    }

    button{
      padding:10px 14px;
      font-weight:700;
      border-radius:8px;
      border:none;
      cursor:pointer;
      background:var(--lion);
      color:#001f3f;
    }

    .hint-small{
      font-size:12px;
      opacity:0.8;
    }

    @media (max-width:600px){
      .count{font-size:50vmin}
      .label{font-size:7vmin}
    }
  </style>
</head>
<body>
  <main class="stage" role="main">
    <div class="left">
      <div id="count" class="count" aria-live="polite">80</div>
      <div class="label">servings left</div>
    </div>

    <div class="right">
      <div class="right-inner">
        <label for="setNumber" style="display:none">Set number</label>
        <input id="setNumber" type="number" inputmode="numeric" placeholder="Enter number" />
        <button id="apply">Set</button>
        <div class="hint-small">Press <strong>Space</strong> to count down · Arrows ↑/↓ add / subtract</div>
      </div>
    </div>
  </main>

  <script>
    (function(){
      const countEl = document.getElementById('count');
      const input = document.getElementById('setNumber');
      const applyBtn = document.getElementById('apply');

      function getValue(){
        const n = parseInt(countEl.textContent.replace(/[^0-9-]/g,''),10);
        return Number.isFinite(n) ? n : 0;
      }

      function setValue(n){
        if (!Number.isFinite(n)) return;
        if (n < 0) n = 0;
        countEl.textContent = String(n);
      }

      function animatePop(){
        countEl.style.transform = 'scale(0.94)';
        countEl.style.opacity = '0.92';
        requestAnimationFrame(()=>{
          setTimeout(()=>{
            countEl.style.transform = '';
            countEl.style.opacity = '';
          },90);
        });
      }

      window.addEventListener('keydown', function(e){
        if (e.code === 'Space' || e.keyCode === 32){
          const active = document.activeElement;
          if (active && (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA' || active.isContentEditable)) return;
          e.preventDefault();
          let val = getValue();
          if (val > 0) {
            setValue(val - 1);
            animatePop();
          }
        }
      });

      applyBtn.addEventListener('click', ()=>{
        const v = parseInt(input.value,10);
        if (!Number.isFinite(v)) return;
        setValue(v);
      });

      input.addEventListener('keydown', function(e){
        if (e.key === 'Enter'){
          e.preventDefault();
          applyBtn.click();
          input.blur();
        }
      });

      (function initFromHash(){
        const h = location.hash.replace('#','');
        const n = parseInt(h,10);
        if (Number.isFinite(n)) setValue(n);
      })();

      countEl.addEventListener('click', ()=>{
        let val = getValue();
        if (val > 0) { setValue(val - 1); animatePop(); }
      });
    })();
  </script>
</body>
</html>
