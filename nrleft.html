<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Food Left Counter</title>
  <style>
    @font-face {
      font-family: 'DIN';
      src: url('fonts/din-condensed-bold.ttf') format('truetype');
      font-weight: 800;
      font-style: normal;
      font-display: swap;
    }
    :root{
      --bg: #001f3f;
      --lion: #F4C430;
    }

    html, body {
      height: 100%;
      margin: 0;
      overflow: hidden;
      font-family: 'DIN';
    }

    body {
      background: var(--bg);
      color: var(--lion);
      display: flex;
      flex-direction: column;
    }

    .stage {
      flex: 1;
      display: flex;
      flex-direction: row;
      height: 100%;
      box-sizing: border-box;
      padding: 0;
    }

    .left {
        display: flex;
      width:55%;
      height:100%;
      justify-content: center;
      align-items: center;
      padding-left: 4vmin;
      min-width: 0;
      flex: 0 0 auto; /* only as wide as its content */
    }

    .count {
      font-weight: 900;
      font-size: 120vh; /* nearly full height */
      line-height: 1;
      margin: 0;
      text-align: left;
      transform-origin: left center;
      padding-top:37%;
      transition: transform 120ms ease, opacity 120ms ease;
      will-change: transform, opacity;
      user-select: none;
      pointer-events: none;
    }

    .small-count {
      font-size: 80vh;
      padding-top: 24.67%;
    }

    .right {
    flex: 1; /* grow to fill remaining space */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    gap: 12px;
    padding: 4vmin;
    padding-top: 0vmin;
    box-sizing: border-box;
    }

    .right-inner {
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 6px;
      align-items: flex-start;
    }

    .label {
      font-size: 55vh;
      font-weight: 700;
      margin: 0;
      padding-top: 30%;
      user-select: none;
      pointer-events: none;
    }

    input[type=number] {
      font-size: 20px;
      padding: 10px 12px;
      border-radius: 8px;
      border: 2px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.03);
      color: #c0c0c0;
      max-width: 160px;
      outline: none;
      box-sizing: border-box;
    }

    button {
      padding: 10px 14px;
      font-weight: 700;
      border-radius: 8px;
      border: 2px solid rgba(255,255,255,0.12);
      cursor: pointer;
      background: transparent;
      color: #c0c0c0;
    }

    .hint-small {
      font-size: 15px;
      color: #c0c0c0;
      text-align: right;
      font-family: Arial, sans-serif;
      align-self: end;
    }

    @media (max-width: 600px){
      .count { font-size: 50vh; }
      .label { font-size: 7vmin; }
    }

    .input-row {
      display: flex;
      gap: 6px;
      align-self: end;
    
    }

    .input-row input {
      flex: 1;

      font-weight: 700;
      border-radius: 8px;
      border: 2px solid rgba(255,255,255,0.12);
      cursor: pointer;
      background: transparent;
      color: #c0c0c0;
    
    }

    .input-row button {
      flex: 0 0 auto;
    }
  </style>
</head>
<body>
  <main class="stage" role="main">
    <div class="left">
      <div id="count" class="count" aria-live="polite" aria-hidden="true">80</div>
    </div>

<div class="right">
  <div class="right-inner">
    <div class="label">left</div>
    <div class="input-row">
      <input id="setNumber" type="number" inputmode="numeric" placeholder="Enter number" />
      <button id="apply">Set</button>
      <button id="fullscreenBtn" title="Toggle Fullscreen">⛶</button>
    </div>
    <div class="hint-small">
      Press <strong>Space</strong> to count down, ↑/↓ add / subtract
    </div>
  </div>
</div>
  </main>

  <script>
    (function(){
      const countEl = document.getElementById('count');
      const input = document.getElementById('setNumber');
      const applyBtn = document.getElementById('apply');
      const fullscreenBtn = document.getElementById('fullscreenBtn');

      // Detect Windows and remove padding-top
      if (navigator.platform.startsWith('Win')) {
        countEl.style.paddingTop = '0';
        const labelEl = document.querySelector('.label');
        if (labelEl) labelEl.style.paddingTop = '0';
      }

      function getValue(){
        const n = parseInt(countEl.textContent.replace(/[^0-9-]/g,''), 10);
        return Number.isFinite(n) ? n : 0;
      }

      function setValue(n){
        if (!Number.isFinite(n)) return;
        if (n < 0) n = 0;
        countEl.textContent = String(n);
        if (n > 99) {
          countEl.classList.add('small-count');
        } else {
          countEl.classList.remove('small-count');
        }
      }

      function animatePop(){
        countEl.style.transform = 'scale(0.94)';
        countEl.style.opacity = '0.92';
        requestAnimationFrame(()=>{
          setTimeout(()=>{
            countEl.style.transform = '';
            countEl.style.opacity = '';
          }, 90);
        });
      }

      // Keyboard controls
      window.addEventListener('keydown', function(e){
        const active = document.activeElement;
        if (active && (active.tagName === 'INPUT' || active.tagName === 'TEXTAREA' || active.isContentEditable)) return;

        if (e.code === 'Space' || e.keyCode === 32){
          if (e.repeat) return;
          e.preventDefault();
          let val = getValue();
          if (val > 0){
            setValue(val - 1);
            animatePop();
          }
        }
        if (e.code === 'ArrowUp'){
          e.preventDefault();
          setValue(getValue() + 1);
        }
        if (e.code === 'ArrowDown'){
          e.preventDefault();
          setValue(getValue() - 1);
        }
      });

      // Button set
      applyBtn.addEventListener('click', ()=>{
        const v = parseInt(input.value, 10);
        if (!Number.isFinite(v)) return;
        setValue(v);
      });

      input.addEventListener('keydown', function(e){
        if (e.key === 'Enter'){
          e.preventDefault();
          applyBtn.click();
          input.blur();
        }
      });

      // Initialize from hash
      (function initFromHash(){
        const h = location.hash.replace('#','');
        const n = parseInt(h, 10);
        if (Number.isFinite(n)) setValue(n);
      })();

      // Click count to decrement
      countEl.addEventListener('click', ()=>{
        let val = getValue();
        if (val > 0){
          setValue(val - 1);
          animatePop();
        }
      });

      // Fullscreen toggle
      fullscreenBtn.addEventListener('click', () => {
        if (!document.fullscreenElement) {
          document.documentElement.requestFullscreen().catch(err => {
            console.error(`Failed to enter fullscreen mode: ${err.message} (${err.name})`);
          });
        } else {
          document.exitFullscreen();
        }
      });
    })();
  </script>
</body>
</html>
